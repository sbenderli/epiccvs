<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>All Resumes — Epic CVs</title>
  <meta name="description" content="Browse all resumes on Epic CVs" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9094816729178059"
     crossorigin="anonymous"></script>
  <style>
    :root { --bg:#0f172a; --panel:#111827; --ink:#e5e7eb; --muted:#94a3b8; --accent:#60a5fa; --border:#1f2937 }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--ink)}
    a{color:var(--ink);text-decoration:none}
    .container{max-width:1100px;margin:0 auto;padding:16px}
    .nav{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
    .nav .left{display:flex;gap:16px;align-items:center}
    .brand{font-weight:700}
  .search-box{margin:12px 0 20px;display:flex;gap:8px}
  .search-input{flex:1;padding:12px;border-radius:8px;border:1px solid var(--border);background:var(--panel);color:var(--ink);font-size:15px}
  .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
    @media(max-width:900px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:600px){.grid{grid-template-columns:1fr}}
  /* larger, vertical cards (image on top) */
  .card{background:var(--panel);border:1px solid var(--border);border-radius:12px;overflow:hidden;display:flex;flex-direction:column}
  .card .thumb{width:100%;height:180px;background:#0b1222;display:block}
  .card .thumb img{width:100%;height:100%;object-fit:cover;display:block}
  .card h3{font-size:18px;margin:12px}
  .card p{margin:0 12px 12px;color:var(--muted)}
  /* Tag container and per-tag chips */
  .card .tags{
    margin:0 12px 12px;
    display:flex;
    gap:8px;
    flex-wrap:wrap;
    align-items:center;
  }
  .card .tag{
    padding:6px 10px;
    background: rgba(255,255,255,0.02);
    color:var(--muted);
    font-size:13px;
    border-radius:999px;
    display:inline-block;
    line-height:1;
    white-space:nowrap;
  }
  .random { padding: 6px 10px; border: 1px solid var(--border); border-radius: 999px; color: var(--muted); background: transparent; }
  .random:hover { border-color: var(--accent); color: var(--ink); }
  /* right-side desktop sticky ad */
  .ad-side{display:none}
  @media(min-width:1000px){
    .ad-side{display:block;position:fixed;right:16px;top:120px;width:300px;z-index:30}
    /* prevent the fixed ad from covering very wide content */
    .container{max-width:1040px}
  }
  </style>
</head>

<body>
  <div class="container">
    <nav class="nav">
      <div class="left">
        <a class="brand" href="/">Epic CVs</a>
        <a href="/">Home</a>
        <a href="/about.html">About</a>
      </div>
      <a class="random" href="#" id="randomBtn">Random CV</a>
    </nav>

    <header style="margin-top:12px">
      <h1 style="margin:0 0 6px">Historical figures, modern resumes</h1>
      <p style="margin:0 0 12px;color:var(--muted)">Browse the collection below. New CVs weekly.</p>
    </header>

    <div class="ad-top">
      <!-- Manual AdSense top banner for homepage: set data-ad-slot to your ad unit id -->
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-9094816729178059"
           data-ad-slot="6043598623"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    </div>

    <!-- Desktop sticky right-side ad (manual) -->
    <div class="ad-side">
      <!-- Manual AdSense sidebar ad for homepage: set data-ad-slot to your ad unit id -->
      <ins class="adsbygoogle"
           style="display:block;width:300px;height:250px"
           data-ad-client="ca-pub-9094816729178059"
           data-ad-slot="6043598623"
           data-ad-format="auto"></ins>
      <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    </div>

    <div class="search-box">
      <input id="q" class="search-input" placeholder="Search resumes" aria-label="Search resumes">
    </div>

    <section id="list" class="grid"></section>

    <div class="ad-bottom">
      <!-- Manual AdSense bottom banner for homepage: set data-ad-slot to your ad unit id -->
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-9094816729178059"
           data-ad-slot="6043598623"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    </div>

    <footer style="margin-top:18px;color:var(--muted)">© <span id="year"></span> Epic CVs</footer>
  </div>

  <script>
    async function loadResumes(){
      try{
        const r = await fetch('./resumes.json', {cache:'no-store'});
        if(!r.ok) return [];
        return await r.json();
      }catch(e){console.error('Failed to load resumes.json',e);return[]}
    }

    function renderList(items){
      const list = document.getElementById('list');
        list.innerHTML = items.map(i=>{
          const tags = (i.tags||[]).map(t=>`<span class="tag">${t}</span>`).join('');
          return `<a class="card" href="/resume.html?id=${encodeURIComponent(i.id)}">
            <div class="thumb">${i.thumb?`<img src="${i.thumb}" alt="${i.title||i.id}" loading="lazy" onerror="this.style.display='none'">`:''}</div>
            <h3>${i.title||i.id}</h3>
            <p class="role">${i.role||''}</p>
            <div class="tags">${tags}</div>
          </a>`
        }).join('');
    }

    (async()=>{
      const resumes = await loadResumes();
  const input = document.getElementById('q');
  const clear = document.getElementById('clear');
  const randomBtn = document.getElementById('randomBtn');
  document.getElementById('year').textContent = new Date().getFullYear();

      renderList(resumes);

      function normalize(s){ return (s||'').toString().toLowerCase(); }
      function matches(item, term){
        const t = normalize(term);
        if(!t) return true;
        if(normalize(item.title).includes(t)) return true;
        if(normalize(item.role).includes(t)) return true;
        if(normalize(item.id).includes(t)) return true;
        if(Array.isArray(item.tags) && item.tags.join(' ').toLowerCase().includes(t)) return true;
        return false;
      }

      input.addEventListener('input', ()=>{
        const q = input.value.trim();
        const filtered = resumes.filter(r=>matches(r,q));
        renderList(filtered);
      });

      // If the old inline "I'm feeling unlucky" button was removed, skip attaching its handler.
      if (clear) {
        clear.addEventListener('click', ()=>{
          // I'm feeling unlucky -> go to a random resume
          if (!resumes || !resumes.length) return;
          const pick = resumes[Math.floor(Math.random() * resumes.length)];
          if (pick) window.location.href = `/resume.html?id=${encodeURIComponent(pick.id)}`;
        });
      }

      // Random CV (nav button) — guard against missing element or empty resumes.
      if (randomBtn) {
        randomBtn.addEventListener('click', e => {
          e.preventDefault();
          if (!resumes || !resumes.length) return;
          const pick = resumes[Math.floor(Math.random() * resumes.length)];
          if (pick) window.location.href = `/resume.html?id=${encodeURIComponent(pick.id)}`;
        });
      }
    })();

    // Hide ad containers if no ad iframe is inserted (useful when viewing locally or before slots are configured)
    (function hideEmptyAds(){
      function checkOnce(){
        document.querySelectorAll('.ad-top,.ad-bottom,.ad-side').forEach(c=>{
          const ins = c.querySelector('ins.adsbygoogle');
          if(!ins){ c.style.display = 'none'; return; }
          if(ins.querySelector('iframe')){ c.style.display = ''; }
          else { c.style.display = 'none'; }
          const mo = new MutationObserver((mutations)=>{
            if(ins.querySelector('iframe')){ c.style.display = ''; mo.disconnect(); }
          });
          mo.observe(ins, { childList: true, subtree: true });
        });
      }
      if (document.readyState === 'complete' || document.readyState === 'interactive') checkOnce();
      else document.addEventListener('DOMContentLoaded', checkOnce);
      setTimeout(checkOnce, 1500);
    })();
  </script>

</body>

</html>
